<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>登录</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
<div class="app-container">


    <!-- 登录页面 -->
    <div class="login-page">
        <!-- 页面头部 -->
        <div class="page-header">
            <div class="header-placeholder"></div>
            <h1>登录</h1>
            <div class="header-placeholder"></div>
        </div>

        <!-- 登录表单 -->
        <div class="login-form">
            <!-- Logo区域 -->
            <div class="logo-section">
                <div class="app-logo">
                    <img src="icons/a-16-kaipiaorenzhengtu.png" alt="App Logo">
                </div>
                <h2>欢迎回来</h2>
                <p class="welcome-text">请登录您的账户</p>
            </div>

            <!-- 登录方式切换 -->
            <div class="login-tabs">
                <button class="tab-btn active" onclick="switchTab('password')" id="passwordTab">密码登录</button>
                <button class="tab-btn" onclick="switchTab('sms')" id="smsTab">验证码登录</button>
            </div>

            <!-- 密码登录表单 -->
            <div class="login-form-content" id="passwordLogin">
                <div class="form-group">
                    <label>手机号</label>
                    <div class="login-input-group">
                        <img src="icons/shoujihao.png" alt="手机" class="input-icon">
                        <input type="tel" id="phoneNumber" placeholder="请输入手机号" maxlength="11">
                    </div>
                </div>

                <div class="form-group">
                    <label>密码</label>
                    <div class="login-input-group">
                        <img src="icons/mima.png" alt="密码" class="input-icon">
                        <input type="password" id="password" placeholder="请输入密码">
                        <button class="toggle-password" onclick="togglePassword('password')">
                            <img src="icons/xianshimima.png" alt="显示密码" id="passwordEye">
                        </button>
                    </div>
                </div>

                <div class="form-options">
                    <label class="checkbox-label">
                        <input type="checkbox" id="rememberMe">
                        <span class="checkmark"></span>
                        记住密码
                    </label>
                    <a href="#" class="forgot-password" onclick="forgotPassword()">忘记密码？</a>
                </div>

                <button class="login-btn" onclick="passwordLogin()">登录</button>
            </div>

            <!-- 验证码登录表单 -->
            <div class="login-form-content hidden" id="smsLogin">
                <div class="form-group">
                    <label>手机号</label>
                    <div class="login-input-group">
                        <img src="icons/shoujihao.png" alt="手机" class="input-icon">
                        <input type="tel" id="smsPhoneNumber" placeholder="请输入手机号" maxlength="11">
                    </div>
                </div>

                <div class="form-group">
                    <label>验证码</label>
                    <div class="login-input-group">
                        <img src="icons/mima.png" alt="验证码" class="input-icon">
                        <input type="text" id="smsCode" placeholder="请输入验证码" maxlength="6">
                        <button class="send-sms-btn" onclick="sendSmsCode()" id="sendSmsBtn">发送验证码</button>
                    </div>
                </div>

                <button class="login-btn" onclick="smsLogin()">登录</button>
            </div>

            <!-- 其他登录方式 -->


            <!-- 注册链接 -->
            <div class="register-link">
                <span>还没有账户？</span>
                <a href="register.html">立即注册</a>
            </div>

            <!-- 用户协议 -->
            <div class="agreement">
                <label class="checkbox-label">
                    <input type="checkbox" id="agreeTerms" checked>
                    <span class="checkmark"></span>
                    我已阅读并同意
                </label>
                <a href="#" onclick="showUserAgreement()">《用户协议》</a>
                <span>和</span>
                <a href="#" onclick="showPrivacyPolicy()">《隐私政策》</a>
            </div>
        </div>
    </div>

    <!-- 忘记密码模态框 -->
    <div class="modal" id="forgotPasswordModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>重置密码</h3>
                <button class="close-btn" onclick="closeModal('forgotPasswordModal')">
                    <img src="icons/shibai.png" alt="关闭">
                </button>
            </div>
            <div class="modal-body">
                <div class="reset-form">
                    <div class="form-group">
                        <label>手机号</label>
                        <div class="login-input-group">
                            <img src="icons/shoujihao.png" alt="手机" class="input-icon">
                            <input type="tel" id="resetPhoneNumber" placeholder="请输入注册手机号" maxlength="11">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>验证码</label>
                        <div class="login-input-group">
                            <img src="icons/mima.png" alt="验证码" class="input-icon">
                            <input type="text" id="resetSmsCode" placeholder="请输入验证码" maxlength="6">
                            <button class="send-sms-btn" onclick="sendResetSmsCode()"
                                    id="resetSmsBtn">发送验证码</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>新密码</label>
                        <div class="login-input-group">
                            <img src="icons/mima.png" alt="密码" class="input-icon">
                            <input type="password" id="newPassword" placeholder="请输入新密码">
                            <button class="toggle-password" onclick="togglePassword('newPassword')">
                                <img src="icons/xianshimima.png" alt="显示密码" id="newPasswordEye">
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>确认密码</label>
                        <div class="login-input-group">
                            <img src="icons/mima.png" alt="密码" class="input-icon">
                            <input type="password" id="confirmPassword" placeholder="请再次输入新密码">
                            <button class="toggle-password" onclick="togglePassword('confirmPassword')">
                                <img src="icons/xianshimima.png" alt="显示密码" id="confirmPasswordEye">
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-cancel" onclick="closeModal('forgotPasswordModal')">取消</button>
                <button class="btn-confirm" onclick="resetPassword()">重置密码</button>
            </div>
        </div>
    </div>
</div>

<script src="script.js"></script>
<script>
    // 登录与密码管理模块：统一封装，消除全局变量，集中管理状态与功能
const AuthModule = {
    // 1. 状态管理：存储模块内关键数据（避免全局变量污染）
    state: {
        apiConfig: {
            baseUrl: "http://graywolf.top:6031/app",
            headers: {
                "User-Agent": "Apifox/1.0.0 (https://apifox.com)",
                "Accept": "*/*"
            }
        },
        countdowns: {
            sms: 0,    // 登录验证码倒计时
            reset: 0   // 重置密码验证码倒计时
        },
        currentTab: "password",  // 当前激活的登录标签（password/sms）
        timerIds: {
            sms: null,  // 登录验证码倒计时定时器
            reset: null // 重置密码验证码倒计时定时器
        }
    },

    // 2. 初始化：页面加载后执行所有初始化逻辑
    init() {
        document.addEventListener("DOMContentLoaded", () => {
            this.checkLoginStatus();  // 检查登录状态
            this.bindModalCloseEvent(); // 绑定模态框背景关闭事件
        });

        // 暴露全局方法：兼容HTML中的onclick调用
        this.exposeGlobalMethods();
    },

    // 暴露全局方法：确保外部可调用模块内功能
    exposeGlobalMethods() {
        window.switchTab = (tabType) => this.switchTab(tabType);
        window.togglePassword = (inputId) => this.togglePassword(inputId);
        window.sendSmsCode = () => this.sendSmsCode();
        window.sendResetSmsCode = () => this.sendResetSmsCode();
        window.passwordLogin = () => this.passwordLogin();
        window.smsLogin = () => this.smsLogin();
        window.wechatLogin = () => this.wechatLogin();
        window.alipayLogin = () => this.alipayLogin();
        window.forgotPassword = () => this.forgotPassword();
        window.resetPassword = () => this.resetPassword();
        window.closeModal = (modalId) => this.closeModal(modalId);
        window.showUserAgreement = () => this.showUserAgreement();
        window.showPrivacyPolicy = () => this.showPrivacyPolicy();
        window.goBack = () => this.goBack();
        window.loadUserProfile = () => this.loadUserProfile();
    },

    // 3. 登录标签切换（密码/验证码登录）
    /**
     * 切换登录方式标签
     * @param {string} tabType - 标签类型（password/sms）
     */
    switchTab(tabType) {
        // 获取DOM元素
        const passwordTab = document.getElementById("passwordTab");
        const smsTab = document.getElementById("smsTab");
        const passwordLogin = document.getElementById("passwordLogin");
        const smsLogin = document.getElementById("smsLogin");

        if (!passwordTab || !smsTab || !passwordLogin || !smsLogin) {
            console.error("登录标签切换相关DOM元素缺失");
            return;
        }

        // 更新标签激活状态
        if (tabType === "password") {
            passwordTab.classList.add("active");
            smsTab.classList.remove("active");
            passwordLogin.classList.remove("hidden");
            smsLogin.classList.add("hidden");
        } else {
            smsTab.classList.add("active");
            passwordTab.classList.remove("active");
            smsLogin.classList.remove("hidden");
            passwordLogin.classList.add("hidden");
        }

        // 更新当前标签状态
        this.state.currentTab = tabType;
    },

    // 4. 密码显示/隐藏切换
    /**
     * 切换密码输入框的显示/隐藏状态
     * @param {string} inputId - 密码输入框ID
     */
    togglePassword(inputId) {
        const input = document.getElementById(inputId);
        const eyeIcon = document.getElementById(`${inputId}Eye`);

        if (!input || !eyeIcon) {
            console.error(`密码切换相关DOM元素缺失（inputId: ${inputId}）`);
            return;
        }

        // 切换输入框类型与图标
        if (input.type === "password") {
            input.type = "text";
            eyeIcon.src = "icons/yincangmima.png";
        } else {
            input.type = "password";
            eyeIcon.src = "icons/xianshimima.png";
        }
    },

    // 5. 验证码发送与倒计时
    /**
     * 发送登录验证码
     */
    sendSmsCode() {
        const phone = document.getElementById("smsPhoneNumber").value;
        const sendBtn = document.getElementById("sendSmsBtn");

        // 基础验证
        if (!this.validatePhoneNumber(phone)) {
            this.showToast("请输入正确的手机号");
            return;
        }
        if (this.state.countdowns.sms > 0) return;

        // 发送验证码请求
        this.sendVerifyCodeRequest(phone, "login", sendBtn, "sms");
    },

    /**
     * 发送重置密码验证码
     */
    sendResetSmsCode() {
        const phone = document.getElementById("resetPhoneNumber").value;
        const sendBtn = document.getElementById("resetSmsBtn");

        // 基础验证
        if (!this.validatePhoneNumber(phone)) {
            this.showToast("请输入正确的手机号");
            return;
        }
        if (this.state.countdowns.reset > 0) return;

        // 发送验证码请求
        this.sendVerifyCodeRequest(phone, "reset", sendBtn, "reset");
    },

    /**
     * 统一发送验证码请求（复用逻辑，减少重复代码）
     * @param {string} phone - 手机号
     * @param {string} scene - 场景（login/reset）
     * @param {HTMLElement} sendBtn - 发送按钮DOM
     * @param {string} countdownType - 倒计时类型（sms/reset）
     */
    sendVerifyCodeRequest(phone, scene, sendBtn, countdownType) {
        const url = new URL(`${this.state.apiConfig.baseUrl}/verifyCode/send`);
        url.searchParams.append("phone", encodeURIComponent(phone));
        url.searchParams.append("scene", scene);

        fetch(url.toString(), {
            method: "GET",
            headers: { ...this.state.apiConfig.headers }
        })
            .then(response => response.json())
            .then(data => {
                if (data.code === 200) {
                    this.showToast(data.message || "验证码已发送到您的手机");
                    // 开启倒计时
                    this.startCountdown(countdownType, sendBtn);
                } else if (data.code === 409) {
                    this.showToast(data.message || "手机号已被注册，请更换手机号");
                } else {
                    this.showToast(data.message || "发送失败，请稍后重试");
                }
            })
            .catch(error => {
                console.error(`发送${scene}验证码失败:", error`);
                this.showToast("网络异常，请检查网络设置");
            });
    },

    /**
     * 开启验证码倒计时（统一处理，支持登录/重置密码场景）
     * @param {string} type - 倒计时类型（sms/reset）
     * @param {HTMLElement} btn - 倒计时按钮DOM
     */
    startCountdown(type, btn) {
        // 清除之前的定时器（避免重复计时）
        if (this.state.timerIds[type]) {
            clearInterval(this.state.timerIds[type]);
        }

        // 初始化倒计时（60秒）
        this.state.countdowns[type] = 60;
        this.updateSmsButton(btn, this.state.countdowns[type]);

        // 启动定时器
        this.state.timerIds[type] = setInterval(() => {
            this.state.countdowns[type]--;
            if (this.state.countdowns[type] <= 0) {
                clearInterval(this.state.timerIds[type]);
                this.state.timerIds[type] = null;
                btn.textContent = "发送验证码";
                btn.disabled = false;
            } else {
                this.updateSmsButton(btn, this.state.countdowns[type]);
            }
        }, 1000);
    },

    /**
     * 更新验证码按钮状态（倒计时显示）
     * @param {HTMLElement} button - 按钮DOM元素
     * @param {number} countdown - 剩余倒计时秒数
     */
    updateSmsButton(button, countdown) {
        button.textContent = `${countdown}s后重发`;
        button.disabled = true;
    },

    // 6. 登录功能（密码/验证码登录）
    /**
     * 密码登录
     */
    passwordLogin() {
        // 获取表单数据
        const phone = document.getElementById("phoneNumber").value;
        const password = document.getElementById("password").value;
        const agreeTerms = document.getElementById("agreeTerms").checked;

        // 前端验证
        if (!this.validateLoginForm(phone, password, agreeTerms)) return;

        // 构建请求数据
        const requestData = {
            phone,
            loginType: "password",
            loginPassword: password,
            verifyCode: ""
        };

        // 发起登录请求
        this.loginRequest(requestData);
    },

    /**
     * 验证码登录
     */
    smsLogin() {
        // 获取表单数据
        const phone = document.getElementById("smsPhoneNumber").value;
        const smsCode = document.getElementById("smsCode").value;
        const agreeTerms = document.getElementById("agreeTerms").checked;

        // 前端验证
        if (!this.validateLoginForm(phone, smsCode, agreeTerms, true)) return;

        // 构建请求数据
        const requestData = {
            phone,
            loginType: "verifyCode",
            verifyCode: smsCode,
            loginPassword: ""
        };

        // 发起登录请求
        this.loginRequest(requestData);
    },

    /**
     * 统一登录请求（复用逻辑，支持密码/验证码登录）
     * @param {Object} requestData - 登录请求数据
     */
    loginRequest(requestData) {
        this.showToast("正在登录中...");

        fetch(`${this.state.apiConfig.baseUrl}/user/login`, {
            method: "POST",
            headers: {
                ...this.state.apiConfig.headers,
                "Content-Type": "application/json"
            },
            body: JSON.stringify(requestData)
        })
            .then(response => {
                if (!response.ok) {
                    return response.json().then(err => { throw err; });
                }
                return response.json();
            })
            .then(data => {
                if (data.code === 200 && data.data) {
                    this.handleLoginSuccess(data.data, requestData.phone);
                } else {
                    this.showToast(data.message || "登录失败，请重试");
                }
            })
            .catch(error => {
                console.error("登录失败:", error);
                this.showToast(error.message || "登录失败，请检查网络或账号信息");
            });
    },

    /**
     * 登录成功后的处理（保存数据+跳转）
     * @param {Object} userData - 接口返回的用户数据
     * @param {string} phone - 登录手机号
     */
    handleLoginSuccess(userData, phone) {
        // 保存到localStorage
        localStorage.setItem("isLoggedIn", "true");
        localStorage.setItem("userPhone", phone);
        localStorage.setItem("userData", JSON.stringify(userData));

        // 调用原生方法保存到Android端（若支持）
        if (window.AndroidInterface) {
            AndroidInterface.saveUserToken(
                userData.token || "",
                userData.userId || "",
                userData.phone || phone
            );
        }

        this.showToast("登录成功！");
        this.loadUserProfile(); // 加载用户资料后跳转首页
    },

    /**
     * 验证登录表单（统一验证逻辑，支持密码/验证码场景）
     * @param {string} phone - 手机号
     * @param {string} inputVal - 密码/验证码
     * @param {boolean} agreeTerms - 是否同意协议
     * @param {boolean} isSmsLogin - 是否为验证码登录
     * @returns {boolean} 验证是否通过
     */
    validateLoginForm(phone, inputVal, agreeTerms, isSmsLogin = false) {
        // 手机号验证
        if (!this.validatePhoneNumber(phone)) {
            this.showToast("请输入正确的手机号");
            return false;
        }

        // 密码/验证码验证
        if (isSmsLogin) {
            if (!inputVal || inputVal.length !== 6) {
                this.showToast("请输入6位验证码");
                return false;
            }
        } else {
            if (!inputVal || inputVal.length < 6) {
                this.showToast("请输入至少6位密码");
                return false;
            }
        }

        // 协议同意验证
        if (!agreeTerms) {
            this.showToast("请同意用户协议和隐私政策");
            return false;
        }

        return true;
    },

    // 7. 第三方登录（微信/支付宝）
    /**
     * 微信登录（待开发）
     */
    wechatLogin() {
        this.showToast("微信登录功能开发中...");
    },

    /**
     * 支付宝登录（待开发）
     */
    alipayLogin() {
        this.showToast("支付宝登录功能开发中...");
    },

    // 8. 密码重置功能
    /**
     * 打开忘记密码模态框
     */
    forgotPassword() {
        const modal = document.getElementById("forgotPasswordModal");
        if (modal) modal.style.display = "flex";
    },

    /**
     * 重置密码（表单验证+接口请求）
     */
    resetPassword() {
        // 获取表单数据
        const phone = document.getElementById("resetPhoneNumber").value.trim();
        const smsCode = document.getElementById("resetSmsCode").value.trim();
        const newPassword = document.getElementById("newPassword").value;
        const confirmPassword = document.getElementById("confirmPassword").value;

        // 前端验证
        if (!this.validateResetPasswordForm(phone, smsCode, newPassword, confirmPassword)) {
            return;
        }

        // 构建请求数据
        const requestData = { phone, verifyCode: smsCode, newPassword };

        // 发起重置请求
        this.showToast("正在重置密码...");
        fetch(`${this.state.apiConfig.baseUrl}/user/password/reset`, {
            method: "POST",
            headers: {
                ...this.state.apiConfig.headers,
                "Content-Type": "application/json"
            },
            body: JSON.stringify(requestData)
        })
            .then(response => {
                if (!response.ok) {
                    console.error("密码重置失败:", {
                        status: response.status,
                        statusText: response.statusText
                    });
                    this.showToast(`网络请求失败 (${response.status} - ${response.statusText})`);
                    return null;
                }
                return response.json();
            })
            .then(data => {
                if (data && data.code === 200) {
                    this.showToast("密码重置成功！请使用新密码登录");
                    this.closeModal("forgotPasswordModal");
                    this.clearResetPasswordForm(); // 清空表单
                } else if (data) {
                    this.showToast(data.message || "密码重置失败，请重试");
                }
            })
            .catch(error => {
                console.error("密码重置异常:", error);
                this.showToast("重置密码时发生错误，请稍后重试");
            });
    },

    /**
     * 验证重置密码表单
     * @param {string} phone - 手机号
     * @param {string} smsCode - 验证码
     * @param {string} newPassword - 新密码
     * @param {string} confirmPassword - 确认密码
     * @returns {boolean} 验证是否通过
     */
    validateResetPasswordForm(phone, smsCode, newPassword, confirmPassword) {
        if (!this.validatePhoneNumber(phone)) {
            this.showToast("请输入正确的手机号");
            return false;
        }
        if (!smsCode || smsCode.length !== 6) {
            this.showToast("请输入6位验证码");
            return false;
        }
        if (!newPassword || newPassword.length < 6) {
            this.showToast("请输入至少6位新密码");
            return false;
        }
        if (newPassword !== confirmPassword) {
            this.showToast("两次输入的密码不一致");
            return false;
        }
        return true;
    },

    /**
     * 清空重置密码表单
     */
    clearResetPasswordForm() {
        document.getElementById("resetPhoneNumber").value = "";
        document.getElementById("resetSmsCode").value = "";
        document.getElementById("newPassword").value = "";
        document.getElementById("confirmPassword").value = "";

        // 重置重置密码倒计时
        if (this.state.timerIds.reset) {
            clearInterval(this.state.timerIds.reset);
            this.state.timerIds.reset = null;
            this.state.countdowns.reset = 0;
            const resetBtn = document.getElementById("resetSmsBtn");
            if (resetBtn) {
                resetBtn.textContent = "发送验证码";
                resetBtn.disabled = false;
                }
        },

        /**
         * 关闭模态框
         * @param {string} modalId - 模态框ID
         */
        closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) modal.style.display = "none";
        },

        // 9. 用户协议与隐私政策
        /**
         * 显示用户协议
         */
        showUserAgreement() {
            this.showToast("用户协议内容...");
        },

        /**
         * 显示隐私政策
         */
        showPrivacyPolicy() {
            this.showToast("隐私政策内容...");
        },

        // 10. 页面导航与用户资料加载
        /**
         * 返回上一页
         */
        goBack() {
            window.history.back();
        },

        /**
         * 加载用户资料并跳转首页
         */
        loadUserProfile() {
            // 获取本地存储的token
            const token = this.getAuthToken();
            if (!token) {
                console.log("未检测到登录状态，无法获取用户资料");
                return;
            }

            // 调用用户资料接口
            fetch(`${this.state.apiConfig.baseUrl}/user/profile`, {
                method: "GET",
                headers: {
                    ...this.state.apiConfig.headers,
                    "Authorization": `Bearer ${token}`
                }
            })
                .then(response => {
                    if (!response.ok) {
                        return response.json().then(err => { throw err; });
                    }
                    return response.json();
                })
                .then(data => {
                    if (data.code === 200 && data.data) {
                        this.updateUserData(data.data); // 更新用户数据
                        window.location.href = "index.html"; // 跳转到首页
                    } else {
                        console.log("获取用户资料失败:", data.msg || "接口返回异常");
                    }
                })
                .catch(error => {
                    console.error("获取用户资料请求失败:", error);
                });
        },

        /**
         * 更新用户数据（合并本地与接口数据）
         * @param {Object} newProfileData - 接口返回的新用户资料
         */
        updateUserData(newProfileData) {
            try {
                // 获取本地已有数据
                const existingUserData = JSON.parse(localStorage.getItem("userData") || "{}");

                // 合并数据（接口数据覆盖本地相同字段，保留本地独有字段）
                const updatedUserData = {
                    ...existingUserData,
                    ...newProfileData
                };

                // 保存更新后的数据
                localStorage.setItem("userData", JSON.stringify(updatedUserData));
                console.log("用户资料更新成功:", updatedUserData);
            } catch (error) {
                console.error("更新用户资料失败:", error);
            }
        },

        // 11. 登录状态检查
        /**
         * 检查登录状态（页面加载时执行）
         */
        checkLoginStatus() {
            // 检查Android原生登录状态（优先）
            if (window.AndroidInterface) {
                try {
                    const userDataStr = AndroidInterface.getUserData();
                    const userData = JSON.parse(userDataStr);

                    // 验证token有效性
                    if (userData && userData.token && userData.token.trim() !== "") {
                        localStorage.setItem("isLoggedIn", "true");
                        localStorage.setItem("userData", JSON.stringify(userData));
                        this.loadUserProfile(); // 加载资料后跳转
                    }
                } catch (error) {
                    console.error("检查原生登录状态失败:", error);
                }
            }
        },

        // 12. 工具方法
        /**
         * 验证手机号格式
         * @param {string} phone - 手机号
         * @returns {boolean} 验证是否通过
         */
        validatePhoneNumber(phone) {
            return /^1[3-9]\d{9}$/.test(phone);
        },

        /**
         * 显示提示信息（兼容原生与Web）
         * @param {string} message - 提示内容
         */
        showToast(message) {
            // 优先使用原生Toast（若支持）
            if (window.AndroidInterface && typeof AndroidInterface.showToast === "function") {
                AndroidInterface.showToast(message);
            } else {
                // Web环境下的简易Toast
                alert(message);
            }
        },

        /**
         * 绑定模态框背景点击关闭事件
         */
        bindModalCloseEvent() {
            document.addEventListener("click", (e) => {
                if (e.target.classList.contains("modal")) {
                    e.target.style.display = "none";
                }
            });
        },

        /**
         * 获取用户Token（统一封装）
         * @returns {string} Token或空字符串
         */
        getAuthToken() {
            try {
                const userData = JSON.parse(localStorage.getItem("userData") || "{}");
                return userData.token || "";
            } catch (error) {
                console.error("获取Token失败:", error);
                return "";
            }
        }
    };

    // 初始化登录模块
    AuthModule.init();
</script>
</body>

</html>